# 图片的构成

任何图片，都是多个单色像素（方块）点构成。图片的大小，是

```java
图片的大小 = 横向的像素点个数 *  纵向像素点的个数 * 每一个像素点的占用空间。
```

得出的结果是：1KB，1MB 等。

# 图片的优化方式

## 方案1：

要优化图片的大小，可以让每一个像素点的占用空间变小。如果让原本一个像素占2个字节，变成一个像素占1个字节，那么整体图片的大小就变成了原来的一半。

## 方案2：

除此之外，还可以将横向纵向的像素点个数变少。比如，横向纵向都变成原来的一半，那么图片整体就变成了原来的四分之一大小。

其实安卓SDK已经提供了这种API。

```kotlin
BitmapFactory.Options
    inPreferedConfig  ARGB_8888 / RGB_565
    inSampleSize 整型，而且必须是2的整数幂
```

`inPreferedConfig` 就是方案1的，ARGB_8888占用32的字节，也就是4位。而RGB_565，则是 16个字节。这是减少每一个像素点所占用的内存空间 来使得图片变小。

`inSampleSize`  如果设置成2，宽高的像素点都会减半。图片整体就会变为原来大小的1/4. 

# 图片的加载方式

## 不使用缓存：

一张图，先在堆中开辟出一片相等大小的内存，加载该图。然后如果我又想去加载一个相同的图，系统会再去开辟一个一样大的内存，再加载一次，而不是去复用前面开辟的内存。如果不断去加载图片，很容易导致内存抖动，内存溢出。这是不使用缓存的情况。



## 而使用缓存 ：

一张图，系统开辟了一片相同大小的堆内存来加载。后面又有一张图要加载的时候，系统会判断新的图，是不是 小于或者等于刚才的堆内存空间，如果小于等于，那么就会去复用刚才的堆内存。



## 三级缓存的原理：

当app需要引用缓存的时候，先用内存缓存，不行就到本地缓存，还不行就到网络异步读取。

所谓三级缓存，就是指的：内存缓存，本地缓存，网络缓存。







